echo -e "# official rabbitmq repo\ndeb http://www.rabbitmq.com/debian/ testing main" > /etc/apt/sources.list.d/rabbitmq.sources.list
wget http://www.rabbitmq.com/rabbitmq-signing-key-public.asc && apt-key add rabbitmq-signing-key-public.asc
apt-get update && apt-get dist-upgrade
apt-get install rabbitmq-server
cd /tmp

# вариант 0 (рабочий)
apt-get install pkg-config
cd /tmp && git clone https://github.com/alanxz/rabbitmq-c.git && cd rabbitmq-c && git submodule init && git submodule update
autoreconf -i && ./configure && make && make install


# I и II - были актуальные, пока не поправили pecl-amqp, на 21.04.2014 все уже ок
# вариант I
cd /tmp
apt-get install cmake
wget https://github.com/alanxz/rabbitmq-c/archive/rabbitmq-c-v0.3.0.zip && unzip ./rabbitmq-c-v0.3.0.zip
cd rabbitmq-* && mkdir build && cd $_ && cmake ..
cmake -DCMAKE_INSTALL_PREFIX=/usr/local ..
cmake --build . --target install

# вариант II
cd /tmp
wget https://github.com/alanxz/rabbitmq-c/archive/rabbitmq-c-v0.3.0.zip && unzip ./rabbitmq-c-v0.3.0.zip
cd rabbitmq-c-rabbitmq-c-v0.3.0
autoreconf -i
./configure && make && make install

# настрока vhost-а, пользователя и прав
rabbitmqctl add_vhost /bn
rabbitmqctl list_vhosts
rabbitmqctl add_user bn-rmq-user 87J71913
rabbitmqctl set_permissions -p /bn bn-rmq-user ".*" ".*" ".*"

# полностью сбросить рабит >>>
rabbitmqctl stop_app && rabbitmqctl reset && rabbitmqctl start_app

